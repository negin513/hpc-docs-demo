<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="NCAR HPC Docs website (Proof of Concept)"><meta name=author content=CISL><link href=https://negin513.github.io/hpc-docs-demo/casper/Compiling%2BGPU%2Bcode%2Bon%2BCasper%2Bnodes/ rel=canonical><link rel=icon href="https://t0.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=https://arc.ucar.edu/knowledge_base/83853599"><meta name=generator content="mkdocs-1.5.2, mkdocs-material-8.5.10"><title>Compiling GPU Code on Casper Nodes - NCAR HPC Documentation</title><link rel=stylesheet href=../../assets/stylesheets/main.975780f9.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.2505c338.min.css><script async src=https://siteimproveanalytics.com/js/siteanalyze_6025767.js></script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Google+Sans:300,300i,400,400i,700,700i%7CRegular:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Google Sans";--md-code-font:"Regular"}</style><link rel=stylesheet href=../../css/timeago.css><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=cisl_default data-md-color-primary=green data-md-color-accent=white> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#compiling-gpu-code-on-casper-nodes class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="NCAR HPC Documentation" class="md-header__button md-logo" aria-label="NCAR HPC Documentation" data-md-component=logo> <img src=../../assets/images/CISL-contemp-logo-white-square.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> NCAR HPC Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Compiling GPU Code on Casper Nodes </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=cisl_default data-md-color-primary=green data-md-color-accent=white aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=idigo data-md-color-accent=white aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/negin513/hpc-docs-demo title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="NCAR HPC Documentation" class="md-nav__button md-logo" aria-label="NCAR HPC Documentation" data-md-component=logo> <img src=../../assets/images/CISL-contemp-logo-white-square.png alt=logo> </a> NCAR HPC Documentation </label> <div class=md-nav__source> <a href=https://github.com/negin513/hpc-docs-demo title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Getting Started <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Getting Started" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../getting-started/ class=md-nav__link> Getting started with NCAR HPC Resources </a> </li> <li class=md-nav__item> <a href=../../general/environment-modules/ class=md-nav__link> Environment Modules </a> </li> <li class=md-nav__item> <a href=../../general/managing-jobs/ class=md-nav__link> Starting and Managing Jobs with PBS </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <div class="md-nav__link md-nav__link--index "> <a href=../ >Casper</a> <label for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Casper data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Casper </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Compiling GPU Code on Casper Nodes <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Compiling GPU Code on Casper Nodes </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#source-code-for-hello_worldcu class=md-nav__link> Source code for hello_world.cu </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <div class="md-nav__link md-nav__link--index "> <a href=../../cheyenne/ >Cheyenne</a> <label for=__nav_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Cheyenne data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Cheyenne </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cheyenne/Quick%2Bstart%2Bon%2BCheyenne/ class=md-nav__link> Quick Start on Cheyenne </a> </li> <li class=md-nav__item> <a href=../../cheyenne/Cheyenne%2Buse%2Bpolicies/ class=md-nav__link> Cheyenne Use Policies </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4 type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4> Starting Cheyenne Jobs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Starting Cheyenne Jobs" data-md-level=2> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Starting Cheyenne Jobs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cheyenne/starting-cheyenne-jobs/Job-submission%2Bqueues%2Band%2Bcharges/ class=md-nav__link> Job-submission Queues and Charges </a> </li> <li class=md-nav__item> <a href=../../cheyenne/starting-cheyenne-jobs/Managing%2Band%2Bmonitoring%2BPBS%2Bjobs/ class=md-nav__link> Managing and monitoring PBS jobs </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4_3 type=checkbox id=__nav_4_4_3> <div class="md-nav__link md-nav__link--index "> <a href=../../cheyenne/starting-cheyenne-jobs/cheyenne-job-script-examples/ >Cheyenne Job Script Examples</a> </div> <nav class=md-nav aria-label="Cheyenne Job Script Examples" data-md-level=3> <label class=md-nav__title for=__nav_4_4_3> <span class="md-nav__icon md-icon"></span> Cheyenne Job Script Examples </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <div class="md-nav__link md-nav__link--index "> <a href=../../derecho/ >Derecho</a> <label for=__nav_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Derecho data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Derecho </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../derecho/Batch%2Bjob%2Bscript%2Bexamples-Derecho/ class=md-nav__link> Batch job script examples - Derecho </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6> <div class="md-nav__link md-nav__link--index "> <a href=../../allocations/ >Allocations</a> <label for=__nav_6> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Allocations data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Allocations </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6_2 type=checkbox id=__nav_6_2> <div class="md-nav__link md-nav__link--index "> <a href=../../allocations/ncar_allocations/ >NCAR Allocations</a> </div> <nav class=md-nav aria-label="NCAR Allocations" data-md-level=2> <label class=md-nav__title for=__nav_6_2> <span class="md-nav__icon md-icon"></span> NCAR Allocations </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class=md-nav__item> <a href=../../allocations/university-allocations.md class=md-nav__link> University Allocations </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7> User Support <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="User Support" data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> User Support </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-support/ class=md-nav__link> User Support </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8 type=checkbox id=__nav_8> <div class="md-nav__link md-nav__link--index "> <a href=../../nhug/ >NCAR User Group</a> <label for=__nav_8> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="NCAR User Group" data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> NCAR User Group </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../nhug/upcoming-events/ class=md-nav__link> NHUG Upcoming Events </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_9 type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9> FAQ <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=FAQ data-md-level=1> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> FAQ </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../esds/faq/ class=md-nav__link> Frequently Asked Questions </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../contributing/ class=md-nav__link> About </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#source-code-for-hello_worldcu class=md-nav__link> Source code for hello_world.cu </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/negin513/hpc-docs-demo/edit/main/docs/casper/Compiling+GPU+code+on+Casper+nodes.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=compiling-gpu-code-on-casper-nodes>Compiling GPU code on Casper nodes<a class=headerlink href=#compiling-gpu-code-on-casper-nodes title="Permanent link">&para;</a></h1> <p>Below is an example of how to compile and run a GPU code interactively on Casper. You can use the CUDA C source code below to make your own <code>hello_world.cu</code> file.</p> <p>Any libraries you build to support an application should be built with the same compiler, compiler version, and compatible flags that were used to compile the other parts of the application, including the main executable(s). Also, when you run the applications, be sure you have loaded the same <a href>module/version environment</a> in which you created the applications. This will avoid job failures that can result from missing mpi launchers and library routines. </p> <hr> <p>Log in to either Casper or Cheyenne and run <code>execcasper</code> with a GPU resource request to start an interactive job on a GPU-accelerated Casper node.</p> <p>Example: <div class=highlight><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>execcasper -l gpu_type=gp100 --ngpus=1
</span></code></pre></div></p> <p>Load the CUDA module when your job starts. <div class=highlight><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>module load cuda
</span></code></pre></div> Use the <code>nvcc</code> command to compile your code. If your code is CUDA Fortran, first load the <code>nvhpc</code> module – the NVIDIA HPC collection – and use the compiler command <code>nvfortran</code> instead. <div class=highlight><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>nvcc -o hello hello_world.cu
</span></code></pre></div> Execute the compiled program as usual. <div class=highlight><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>./hello
</span></code></pre></div> Output: <div class=highlight><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>Contents of data before kernel call: HdjikhjcZ
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>Contents of data after kernel call:  Hello World!
</span></code></pre></div></p> <h3 id=source-code-for-hello_worldcu>Source code for <code>hello_world.cu</code><a class=headerlink href=#source-code-for-hello_worldcu title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=o>/</span><span class=err>\</span><span class=o>*</span><span class=w> </span><span class=n>hello</span><span class=err>\</span><span class=n>_world</span><span class=p>.</span><span class=n>cu</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=err>`</span><span class=w> </span><span class=err>`\</span><span class=o>*</span><span class=w> </span><span class=o>---------------------------------------------------</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=err>`</span><span class=w> </span><span class=err>`\</span><span class=o>*</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=n>Hello</span><span class=w> </span><span class=n>World</span><span class=w> </span><span class=n>example</span><span class=w> </span><span class=n>in</span><span class=w> </span><span class=n>CUDA</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=err>`</span><span class=w> </span><span class=err>`\</span><span class=o>*</span><span class=w> </span><span class=o>---------------------------------------------------</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=err>`</span><span class=w> </span><span class=err>`\</span><span class=o>*</span><span class=w> </span><span class=n>This</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=kt>short</span><span class=w> </span><span class=n>program</span><span class=w> </span><span class=n>which</span><span class=w> </span><span class=n>uses</span><span class=w> </span><span class=n>multiple</span><span class=w> </span><span class=n>CUDA</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=err>`</span><span class=w> </span><span class=err>`\</span><span class=o>*</span><span class=w> </span><span class=n>threads</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>calculate</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=s>&quot;Hello World&quot;</span><span class=w> </span><span class=n>message</span><span class=w> </span><span class=n>which</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=err>`</span><span class=w> </span><span class=err>`\</span><span class=o>*</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>then</span><span class=w> </span><span class=n>printed</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>screen</span><span class=p>.</span><span class=w>  </span><span class=n>It</span><span class=err>&#39;</span><span class=n>s</span><span class=w> </span><span class=n>intended</span><span class=w> </span><span class=n>to</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=err>`</span><span class=w> </span><span class=err>`\</span><span class=o>*</span><span class=w> </span><span class=n>demonstrate</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>execution</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>CUDA</span><span class=w> </span><span class=n>kernel</span><span class=p>.</span>
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a>
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=err>`</span><span class=w> </span><span class=err>`\</span><span class=o>*</span><span class=w> </span><span class=o>---------------------------------------------------</span>
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a>
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a><span class=err>`</span><span class=w> </span><span class=err>`\</span><span class=o>*/</span>
</span><span id=__span-5-20><a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a>
</span><span id=__span-5-21><a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a><span class=cp>#define SIZE 12</span>
</span><span id=__span-5-22><a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a>
</span><span id=__span-5-23><a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdio.h&gt;</span>
</span><span id=__span-5-24><a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a>
</span><span id=__span-5-25><a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdlib.h&gt;</span>
</span><span id=__span-5-26><a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a>
</span><span id=__span-5-27><a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;cuda\_runtime.h&gt;</span>
</span><span id=__span-5-28><a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a>
</span><span id=__span-5-29><a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a><span class=o>/</span><span class=err>\</span><span class=o>*</span><span class=w> </span><span class=n>CUDA</span><span class=w> </span><span class=n>kernel</span><span class=w> </span><span class=n>used</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>calculate</span><span class=w> </span><span class=n>hello</span><span class=w> </span><span class=n>world</span><span class=w> </span><span class=n>message</span><span class=w> </span><span class=err>\</span><span class=o>*/</span>
</span><span id=__span-5-30><a id=__codelineno-5-30 name=__codelineno-5-30 href=#__codelineno-5-30></a>
</span><span id=__span-5-31><a id=__codelineno-5-31 name=__codelineno-5-31 href=#__codelineno-5-31></a><span class=err>\</span><span class=n>_</span><span class=err>\</span><span class=n>_global</span><span class=err>\</span><span class=n>_</span><span class=err>\</span><span class=n>_</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=n>hello</span><span class=err>\</span><span class=n>_world</span><span class=p>(</span><span class=kt>char</span><span class=w> </span><span class=err>\</span><span class=o>*</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>N</span><span class=p>);</span>
</span><span id=__span-5-32><a id=__codelineno-5-32 name=__codelineno-5-32 href=#__codelineno-5-32></a>
</span><span id=__span-5-33><a id=__codelineno-5-33 name=__codelineno-5-33 href=#__codelineno-5-33></a><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>argc</span><span class=p>,</span><span class=w> </span><span class=kt>char</span><span class=w> </span><span class=err>\</span><span class=o>*</span><span class=err>\</span><span class=o>*</span><span class=n>argv</span><span class=p>)</span>
</span><span id=__span-5-34><a id=__codelineno-5-34 name=__codelineno-5-34 href=#__codelineno-5-34></a>
</span><span id=__span-5-35><a id=__codelineno-5-35 name=__codelineno-5-35 href=#__codelineno-5-35></a><span class=p>{</span>
</span><span id=__span-5-36><a id=__codelineno-5-36 name=__codelineno-5-36 href=#__codelineno-5-36></a>
</span><span id=__span-5-37><a id=__codelineno-5-37 name=__codelineno-5-37 href=#__codelineno-5-37></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=o>/</span><span class=err>\</span><span class=o>*</span><span class=w> </span><span class=n>data</span><span class=w> </span><span class=n>that</span><span class=w> </span><span class=n>will</span><span class=w> </span><span class=n>live</span><span class=w> </span><span class=n>on</span><span class=w> </span><span class=n>host</span><span class=w> </span><span class=err>\</span><span class=o>*/</span>
</span><span id=__span-5-38><a id=__codelineno-5-38 name=__codelineno-5-38 href=#__codelineno-5-38></a>
</span><span id=__span-5-39><a id=__codelineno-5-39 name=__codelineno-5-39 href=#__codelineno-5-39></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=kt>char</span><span class=w> </span><span class=err>\</span><span class=o>*</span><span class=n>data</span><span class=p>;</span>
</span><span id=__span-5-40><a id=__codelineno-5-40 name=__codelineno-5-40 href=#__codelineno-5-40></a>
</span><span id=__span-5-41><a id=__codelineno-5-41 name=__codelineno-5-41 href=#__codelineno-5-41></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=o>/</span><span class=err>\</span><span class=o>*</span><span class=w> </span><span class=n>data</span><span class=w> </span><span class=n>that</span><span class=w> </span><span class=n>will</span><span class=w> </span><span class=n>live</span><span class=w> </span><span class=n>in</span><span class=w> </span><span class=n>device</span><span class=w> </span><span class=n>memory</span><span class=w> </span><span class=err>\</span><span class=o>*/</span>
</span><span id=__span-5-42><a id=__codelineno-5-42 name=__codelineno-5-42 href=#__codelineno-5-42></a>
</span><span id=__span-5-43><a id=__codelineno-5-43 name=__codelineno-5-43 href=#__codelineno-5-43></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=kt>char</span><span class=w> </span><span class=err>\</span><span class=o>*</span><span class=n>d</span><span class=err>\</span><span class=n>_data</span><span class=p>;</span>
</span><span id=__span-5-44><a id=__codelineno-5-44 name=__codelineno-5-44 href=#__codelineno-5-44></a>
</span><span id=__span-5-45><a id=__codelineno-5-45 name=__codelineno-5-45 href=#__codelineno-5-45></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=o>/</span><span class=err>\</span><span class=o>*</span><span class=w> </span><span class=n>allocate</span><span class=w> </span><span class=n>and</span><span class=w> </span><span class=n>initialize</span><span class=w> </span><span class=n>data</span><span class=w> </span><span class=n>array</span><span class=w> </span><span class=err>\</span><span class=o>*/</span>
</span><span id=__span-5-46><a id=__codelineno-5-46 name=__codelineno-5-46 href=#__codelineno-5-46></a>
</span><span id=__span-5-47><a id=__codelineno-5-47 name=__codelineno-5-47 href=#__codelineno-5-47></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=n>data</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=kt>char</span><span class=err>\</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=n>malloc</span><span class=p>(</span><span class=n>SIZE</span><span class=err>\</span><span class=o>*</span><span class=k>sizeof</span><span class=p>(</span><span class=kt>char</span><span class=p>));</span>
</span><span id=__span-5-48><a id=__codelineno-5-48 name=__codelineno-5-48 href=#__codelineno-5-48></a>
</span><span id=__span-5-49><a id=__codelineno-5-49 name=__codelineno-5-49 href=#__codelineno-5-49></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=n>data</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w>  </span><span class=o>=</span><span class=w>  </span><span class=mi>72</span><span class=p>;</span><span class=w> </span><span class=n>data</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w>  </span><span class=o>=</span><span class=w> </span><span class=mi>100</span><span class=p>;</span><span class=w> </span><span class=n>data</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w>  </span><span class=o>=</span><span class=w> </span><span class=mi>106</span><span class=p>;</span>
</span><span id=__span-5-50><a id=__codelineno-5-50 name=__codelineno-5-50 href=#__codelineno-5-50></a>
</span><span id=__span-5-51><a id=__codelineno-5-51 name=__codelineno-5-51 href=#__codelineno-5-51></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=n>data</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=w>  </span><span class=o>=</span><span class=w> </span><span class=mi>105</span><span class=p>;</span><span class=w> </span><span class=n>data</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=w>  </span><span class=o>=</span><span class=w> </span><span class=mi>107</span><span class=p>;</span><span class=w> </span><span class=n>data</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=w>  </span><span class=o>=</span><span class=w>  </span><span class=mi>27</span><span class=p>;</span>
</span><span id=__span-5-52><a id=__codelineno-5-52 name=__codelineno-5-52 href=#__codelineno-5-52></a>
</span><span id=__span-5-53><a id=__codelineno-5-53 name=__codelineno-5-53 href=#__codelineno-5-53></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=n>data</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span><span class=w>  </span><span class=o>=</span><span class=w>  </span><span class=mi>81</span><span class=p>;</span><span class=w> </span><span class=n>data</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span><span class=w>  </span><span class=o>=</span><span class=w> </span><span class=mi>104</span><span class=p>;</span><span class=w> </span><span class=n>data</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span><span class=w>  </span><span class=o>=</span><span class=w> </span><span class=mi>106</span><span class=p>;</span>
</span><span id=__span-5-54><a id=__codelineno-5-54 name=__codelineno-5-54 href=#__codelineno-5-54></a>
</span><span id=__span-5-55><a id=__codelineno-5-55 name=__codelineno-5-55 href=#__codelineno-5-55></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=n>data</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span><span class=w>  </span><span class=o>=</span><span class=w>  </span><span class=mi>99</span><span class=p>;</span><span class=w> </span><span class=n>data</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w>  </span><span class=mi>90</span><span class=p>;</span><span class=w> </span><span class=n>data</span><span class=p>[</span><span class=mi>11</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w>  </span><span class=mi>22</span><span class=p>;</span>
</span><span id=__span-5-56><a id=__codelineno-5-56 name=__codelineno-5-56 href=#__codelineno-5-56></a>
</span><span id=__span-5-57><a id=__codelineno-5-57 name=__codelineno-5-57 href=#__codelineno-5-57></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=o>/</span><span class=err>\</span><span class=o>*</span><span class=w> </span><span class=n>print</span><span class=w> </span><span class=n>data</span><span class=w> </span><span class=n>before</span><span class=w> </span><span class=n>kernel</span><span class=w> </span><span class=n>call</span><span class=w> </span><span class=err>\</span><span class=o>*/</span>
</span><span id=__span-5-58><a id=__codelineno-5-58 name=__codelineno-5-58 href=#__codelineno-5-58></a>
</span><span id=__span-5-59><a id=__codelineno-5-59 name=__codelineno-5-59 href=#__codelineno-5-59></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;Contents of data before kernel call: %s</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>data</span><span class=p>);</span>
</span><span id=__span-5-60><a id=__codelineno-5-60 name=__codelineno-5-60 href=#__codelineno-5-60></a>
</span><span id=__span-5-61><a id=__codelineno-5-61 name=__codelineno-5-61 href=#__codelineno-5-61></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=o>/</span><span class=err>\</span><span class=o>*</span><span class=w> </span><span class=n>allocate</span><span class=w> </span><span class=n>memory</span><span class=w> </span><span class=n>on</span><span class=w> </span><span class=n>device</span><span class=w> </span><span class=err>\</span><span class=o>*/</span>
</span><span id=__span-5-62><a id=__codelineno-5-62 name=__codelineno-5-62 href=#__codelineno-5-62></a>
</span><span id=__span-5-63><a id=__codelineno-5-63 name=__codelineno-5-63 href=#__codelineno-5-63></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=n>cudaMalloc</span><span class=p>(</span><span class=o>&amp;</span><span class=n>d</span><span class=err>\</span><span class=n>_data</span><span class=p>,</span><span class=w> </span><span class=n>SIZE</span><span class=err>\</span><span class=o>*</span><span class=k>sizeof</span><span class=p>(</span><span class=kt>char</span><span class=p>));</span>
</span><span id=__span-5-64><a id=__codelineno-5-64 name=__codelineno-5-64 href=#__codelineno-5-64></a>
</span><span id=__span-5-65><a id=__codelineno-5-65 name=__codelineno-5-65 href=#__codelineno-5-65></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=o>/</span><span class=err>\</span><span class=o>*</span><span class=w> </span><span class=n>copy</span><span class=w> </span><span class=n>memory</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>device</span><span class=w> </span><span class=n>array</span><span class=w> </span><span class=err>\</span><span class=o>*/</span>
</span><span id=__span-5-66><a id=__codelineno-5-66 name=__codelineno-5-66 href=#__codelineno-5-66></a>
</span><span id=__span-5-67><a id=__codelineno-5-67 name=__codelineno-5-67 href=#__codelineno-5-67></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=n>cudaMemcpy</span><span class=p>(</span><span class=n>d</span><span class=err>\</span><span class=n>_data</span><span class=p>,</span><span class=w> </span><span class=n>data</span><span class=p>,</span><span class=w> </span><span class=n>SIZE</span><span class=p>,</span><span class=w> </span><span class=n>cudaMemcpyHostToDevice</span><span class=p>);</span>
</span><span id=__span-5-68><a id=__codelineno-5-68 name=__codelineno-5-68 href=#__codelineno-5-68></a>
</span><span id=__span-5-69><a id=__codelineno-5-69 name=__codelineno-5-69 href=#__codelineno-5-69></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=o>/</span><span class=err>\</span><span class=o>*</span><span class=w> </span><span class=n>call</span><span class=w> </span><span class=n>kernel</span><span class=w> </span><span class=err>\</span><span class=o>*/</span>
</span><span id=__span-5-70><a id=__codelineno-5-70 name=__codelineno-5-70 href=#__codelineno-5-70></a>
</span><span id=__span-5-71><a id=__codelineno-5-71 name=__codelineno-5-71 href=#__codelineno-5-71></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=n>hello</span><span class=err>\</span><span class=n>_world</span><span class=o>&lt;&lt;&lt;</span><span class=mi>4</span><span class=p>,</span><span class=mi>3</span><span class=o>&gt;&gt;&gt;</span><span class=p>(</span><span class=n>d</span><span class=err>\</span><span class=n>_data</span><span class=p>,</span><span class=w> </span><span class=n>SIZE</span><span class=p>);</span>
</span><span id=__span-5-72><a id=__codelineno-5-72 name=__codelineno-5-72 href=#__codelineno-5-72></a>
</span><span id=__span-5-73><a id=__codelineno-5-73 name=__codelineno-5-73 href=#__codelineno-5-73></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=o>/</span><span class=err>\</span><span class=o>*</span><span class=w> </span><span class=n>copy</span><span class=w> </span><span class=n>data</span><span class=w> </span><span class=n>back</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>host</span><span class=w> </span><span class=err>\</span><span class=o>*/</span>
</span><span id=__span-5-74><a id=__codelineno-5-74 name=__codelineno-5-74 href=#__codelineno-5-74></a>
</span><span id=__span-5-75><a id=__codelineno-5-75 name=__codelineno-5-75 href=#__codelineno-5-75></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=n>cudaMemcpy</span><span class=p>(</span><span class=n>data</span><span class=p>,</span><span class=w> </span><span class=n>d</span><span class=err>\</span><span class=n>_data</span><span class=p>,</span><span class=w> </span><span class=n>SIZE</span><span class=p>,</span><span class=w> </span><span class=n>cudaMemcpyDeviceToHost</span><span class=p>);</span>
</span><span id=__span-5-76><a id=__codelineno-5-76 name=__codelineno-5-76 href=#__codelineno-5-76></a>
</span><span id=__span-5-77><a id=__codelineno-5-77 name=__codelineno-5-77 href=#__codelineno-5-77></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=o>/</span><span class=err>\</span><span class=o>*</span><span class=w> </span><span class=n>print</span><span class=w> </span><span class=n>contents</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>array</span><span class=w> </span><span class=err>\</span><span class=o>*/</span>
</span><span id=__span-5-78><a id=__codelineno-5-78 name=__codelineno-5-78 href=#__codelineno-5-78></a>
</span><span id=__span-5-79><a id=__codelineno-5-79 name=__codelineno-5-79 href=#__codelineno-5-79></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;Contents of data after kernel call:  %s</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=n>data</span><span class=p>);</span>
</span><span id=__span-5-80><a id=__codelineno-5-80 name=__codelineno-5-80 href=#__codelineno-5-80></a>
</span><span id=__span-5-81><a id=__codelineno-5-81 name=__codelineno-5-81 href=#__codelineno-5-81></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=o>/</span><span class=err>\</span><span class=o>*</span><span class=w> </span><span class=n>clean</span><span class=w> </span><span class=n>up</span><span class=w> </span><span class=n>memory</span><span class=w> </span><span class=n>on</span><span class=w> </span><span class=n>host</span><span class=w> </span><span class=n>and</span><span class=w> </span><span class=n>device</span><span class=w> </span><span class=err>\</span><span class=o>*/</span>
</span><span id=__span-5-82><a id=__codelineno-5-82 name=__codelineno-5-82 href=#__codelineno-5-82></a>
</span><span id=__span-5-83><a id=__codelineno-5-83 name=__codelineno-5-83 href=#__codelineno-5-83></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=n>cudaFree</span><span class=p>(</span><span class=n>d</span><span class=err>\</span><span class=n>_data</span><span class=p>);</span>
</span><span id=__span-5-84><a id=__codelineno-5-84 name=__codelineno-5-84 href=#__codelineno-5-84></a>
</span><span id=__span-5-85><a id=__codelineno-5-85 name=__codelineno-5-85 href=#__codelineno-5-85></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=n>free</span><span class=p>(</span><span class=n>data</span><span class=p>);</span>
</span><span id=__span-5-86><a id=__codelineno-5-86 name=__codelineno-5-86 href=#__codelineno-5-86></a>
</span><span id=__span-5-87><a id=__codelineno-5-87 name=__codelineno-5-87 href=#__codelineno-5-87></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=k>return</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span><span id=__span-5-88><a id=__codelineno-5-88 name=__codelineno-5-88 href=#__codelineno-5-88></a>
</span><span id=__span-5-89><a id=__codelineno-5-89 name=__codelineno-5-89 href=#__codelineno-5-89></a><span class=p>}</span>
</span><span id=__span-5-90><a id=__codelineno-5-90 name=__codelineno-5-90 href=#__codelineno-5-90></a>
</span><span id=__span-5-91><a id=__codelineno-5-91 name=__codelineno-5-91 href=#__codelineno-5-91></a><span class=o>/</span><span class=err>\</span><span class=o>*</span><span class=w> </span><span class=n>hello</span><span class=err>\</span><span class=n>_world</span>
</span><span id=__span-5-92><a id=__codelineno-5-92 name=__codelineno-5-92 href=#__codelineno-5-92></a>
</span><span id=__span-5-93><a id=__codelineno-5-93 name=__codelineno-5-93 href=#__codelineno-5-93></a><span class=err>`</span><span class=w> </span><span class=err>`\</span><span class=o>*</span><span class=w> </span><span class=n>Each</span><span class=w> </span><span class=kr>thread</span><span class=w> </span><span class=n>increments</span><span class=w> </span><span class=n>an</span><span class=w> </span><span class=n>element</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>input</span>
</span><span id=__span-5-94><a id=__codelineno-5-94 name=__codelineno-5-94 href=#__codelineno-5-94></a>
</span><span id=__span-5-95><a id=__codelineno-5-95 name=__codelineno-5-95 href=#__codelineno-5-95></a><span class=err>`</span><span class=w> </span><span class=err>`\</span><span class=o>*</span><span class=w> </span><span class=n>array</span><span class=w> </span><span class=n>by</span><span class=w> </span><span class=n>its</span><span class=w> </span><span class=n>global</span><span class=w> </span><span class=kr>thread</span><span class=w> </span><span class=n>id</span>
</span><span id=__span-5-96><a id=__codelineno-5-96 name=__codelineno-5-96 href=#__codelineno-5-96></a>
</span><span id=__span-5-97><a id=__codelineno-5-97 name=__codelineno-5-97 href=#__codelineno-5-97></a><span class=err>`</span><span class=w> </span><span class=err>`\</span><span class=o>*/</span>
</span><span id=__span-5-98><a id=__codelineno-5-98 name=__codelineno-5-98 href=#__codelineno-5-98></a>
</span><span id=__span-5-99><a id=__codelineno-5-99 name=__codelineno-5-99 href=#__codelineno-5-99></a><span class=err>\</span><span class=n>_</span><span class=err>\</span><span class=n>_global</span><span class=err>\</span><span class=n>_</span><span class=err>\</span><span class=n>_</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=n>hello</span><span class=err>\</span><span class=n>_world</span><span class=p>(</span><span class=kt>char</span><span class=w> </span><span class=err>\</span><span class=o>*</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>N</span><span class=p>)</span>
</span><span id=__span-5-100><a id=__codelineno-5-100 name=__codelineno-5-100 href=#__codelineno-5-100></a>
</span><span id=__span-5-101><a id=__codelineno-5-101 name=__codelineno-5-101 href=#__codelineno-5-101></a><span class=p>{</span>
</span><span id=__span-5-102><a id=__codelineno-5-102 name=__codelineno-5-102 href=#__codelineno-5-102></a>
</span><span id=__span-5-103><a id=__codelineno-5-103 name=__codelineno-5-103 href=#__codelineno-5-103></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>blockDim</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=err>\</span><span class=o>*</span><span class=w> </span><span class=n>blockIdx</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>threadIdx</span><span class=p>.</span><span class=n>x</span><span class=p>;</span>
</span><span id=__span-5-104><a id=__codelineno-5-104 name=__codelineno-5-104 href=#__codelineno-5-104></a>
</span><span id=__span-5-105><a id=__codelineno-5-105 name=__codelineno-5-105 href=#__codelineno-5-105></a><span class=err>`</span><span class=w>   </span><span class=err>`</span><span class=k>if</span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>N</span><span class=p>)</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
</span><span id=__span-5-106><a id=__codelineno-5-106 name=__codelineno-5-106 href=#__codelineno-5-106></a>
</span><span id=__span-5-107><a id=__codelineno-5-107 name=__codelineno-5-107 href=#__codelineno-5-107></a><span class=p>}</span>
</span></code></pre></div> <p>Copy of <a href=https://arc.ucar.edu/knowledge_base/72581399>https://arc.ucar.edu/knowledge_base/72581399</a></p> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2023-08-28T20:08:11+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-08-28</span> <br> Created: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2023-08-28T20:08:11+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-08-28</span> </small> </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label> <a href=../ class="md-footer__link md-footer__link--prev" aria-label="Previous: Casper cluster" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Casper cluster </div> </div> </a> <a href=../../cheyenne/ class="md-footer__link md-footer__link--next" aria-label="Next: Cheyenne supercomputer" rel=next> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Cheyenne supercomputer </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> &copy; 2023 UCAR </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://arc.ucar.edu/ target=_blank rel=noopener title=arc.ucar.edu class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19.07 4.93C17.22 3 14.66 1.96 12 2c-2.66-.04-5.21 1-7.06 2.93C3 6.78 1.96 9.34 2 12c-.04 2.66 1 5.21 2.93 7.06C6.78 21 9.34 22.04 12 22c2.66.04 5.21-1 7.06-2.93C21 17.22 22.04 14.66 22 12c.04-2.66-1-5.22-2.93-7.07M17 12v6h-3.5v-5h-3v5H7v-6H5l7-7 7.5 7H17Z"/></svg> </a> <a href=https://ithelp.ucar.edu/plugins/servlet/desk/site/rc target=_blank rel=noopener title=ithelp.ucar.edu class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m15.07 11.25-.9.92C13.45 12.89 13 13.5 13 15h-2v-.5c0-1.11.45-2.11 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41a2 2 0 0 0-2-2 2 2 0 0 0-2 2H8a4 4 0 0 1 4-4 4 4 0 0 1 4 4 3.2 3.2 0 0 1-.93 2.25M13 19h-2v-2h2M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10c0-5.53-4.5-10-10-10Z"/></svg> </a> <a href=https://github.com/NCAR target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://join.slack.com/t/ncarhpcusergroup/shared_invite/zt-1z00napom-SU0X8CzJWVY90C2GzRvUCg target=_blank rel=noopener title=join.slack.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg> </a> </div> </div> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <img alt="National Science Foundation" src=https://www.nsf.gov/news/mmg/media/images/bitmaplogo_nolayers_f_e50fcd0b-607b-4271-a808-914d9c2f65dc.png height=70 width=90> This material is based upon work supported by the National Center for Atmospheric Research, a major facility sponsored by National Science Foundation and managed by the University Corporation for Atmospheric Research. Any opinions, findings and conclusions or recommendations expressed in this material do not necessarily reflect the views of the National Science Foundation. </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.annotate", "content.code.copy", "content.action.edit", "content.action.view", "navigation.footer", "navigation.indexes", "navigation.top", "navigation.path", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script>
  var __search = {
    transform: function (query) {
      return query
    }
  }
</script> <script src=../../assets/javascripts/bundle.5a2dcb6a.min.js></script> <script src=../../js/timeago.min.js></script> <script src=../../js/timeago_mkdocs_material.js></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>